<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.290">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Julia &amp; Numerical Anlaysis - 토모그래피</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../src/image_processing/fourier_transform.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Julia &amp; Numerical Anlaysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="검색"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="탐색 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../src/introduction_to_julia/index.html" rel="" target="">
 <span class="menu-text">Julia 프로그래밍 언어</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../src/numerical_analysis_using_julia/index.html" rel="" target="">
 <span class="menu-text">Julia 언어를 이용한 수치해석</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../src/image_processing/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">영상 처리와 토모그래피</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../src/tools/tools.html" rel="" target="">
 <span class="menu-text">Tools</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
    <a href="mailto:julia.kaeri@gmail.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/image_processing/tomography.html">주제별 처리</a></li><li class="breadcrumb-item"><a href="../../src/image_processing/tomography.html">토모그래피</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">영상 처리 기초</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/image_processing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">영상 처리와 토모그래피</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/image_processing/introduction_to_signal_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">디지털 신호처리의 기초</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/image_processing/fourier_transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">푸리에 변환</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">주제별 처리</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/image_processing/tomography.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">토모그래피</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#토모그래피" id="toc-토모그래피" class="nav-link active" data-scroll-target="#토모그래피"><span class="header-section-number">1</span> 토모그래피</a></li>
  <li><a href="#projection" id="toc-projection" class="nav-link" data-scroll-target="#projection"><span class="header-section-number">2</span> Projection</a></li>
  <li><a href="#fourier-slice-theorem" id="toc-fourier-slice-theorem" class="nav-link" data-scroll-target="#fourier-slice-theorem"><span class="header-section-number">3</span> Fourier Slice Theorem</a>
  <ul class="collapse">
  <li><a href="#푸리에-변환과-역변환" id="toc-푸리에-변환과-역변환" class="nav-link" data-scroll-target="#푸리에-변환과-역변환">푸리에 변환과 역변환</a></li>
  <li><a href="#projection-과-푸리에변환" id="toc-projection-과-푸리에변환" class="nav-link" data-scroll-target="#projection-과-푸리에변환">Projection 과 푸리에변환</a></li>
  </ul></li>
  <li><a href="#filtered-back-projeciton" id="toc-filtered-back-projeciton" class="nav-link" data-scroll-target="#filtered-back-projeciton"><span class="header-section-number">4</span> Filtered back projeciton</a>
  <ul class="collapse">
  <li><a href="#filtered-projection" id="toc-filtered-projection" class="nav-link" data-scroll-target="#filtered-projection">Filtered projection</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">토모그래피</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="토모그래피" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="토모그래피"><span class="header-section-number">1</span> 토모그래피</h2>
<p>토모그래피의 기본적인 개념은 아래 그림과 같다. 중성자나 X 선과 같이 물질을 투과하는 성질이 강한 입자를 물질에 쐬어 주면 대부분의 입자가 물질을 투과하여 검출기에 검출된다. 하지만 모든 입자가 투과하지는 못하며 물질의 성질에 따라 일부 입자가 산란되거나 흡수되며 검출기에서는 산란되거나 흡수되지 않고 투과되는 빔의 강도를 검출기 위치별로 측정한다. 검출기는 1차원일수도 있고 2차원 일 수도 있다.</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/tomography/tomography.png" class="quarto-discovered-preview-image img-fluid figure-img" width="600"></p>
<p></p><figcaption class="figure-caption">Tomography</figcaption><p></p>
</figure>
</div>
</center>
<p>비에 따라 (1) 검출기와 선원이 고정된 상태에서 측정 대상이 회전중심을 기준으로 회전할 수도 있고, (2) 측정 대상이 고정된 상태에서 검출기와 선원(radiation source) 이 회전할 수도 있다. 우리는 앞서 라돈 변환을 설명할 때 (1) 의 경우에 대대 설명했지만, 수학적인 설명은 (2) 의 경우를 기준으로 설명하겠다. (이 분야의 대표적인 교과서들이 (2) 를 기준으로 설명하였으므로…) 물리적으로는 (1) 과 (2) 는 서로 회전 방향이 반대라면 동일하다. 즉 (1) 의 경우 시계방향으로 <span class="math inline">\(\theta\)</span> 만큼의 회전은 (2) 의 경우에서 반시계방향으로 <span class="math inline">\(\theta\)</span> 만큼의 회전과 완전히 동일하다.</p>
<p>물질의 위치에 따른 선형 감쇄 계수가 <span class="math inline">\(\mu (x,\,y)\)</span> 로 주어졌다고 하자. 감쇄 계수는 <span class="math inline">\(I_0\)</span> 의 강도로 입사된 빔이 <span class="math inline">\(ds\)</span> 만큼의 경로를 진행했을 때 감소되는 빔의 강도이다. 즉,</p>
<p><span class="math display">\[
\mu = -\dfrac{1}{I}\dfrac{dI}{ds}
\]</span></p>
<p>이다. 선원에서 <span class="math inline">\(I_0\)</span> 의 빔의 강도를 가진 빔이 <span class="math inline">\(S\)</span> 의 경로를 따라 갔을 때의 빔의 강도는</p>
<p><span id="eq-beam_intensity"><span class="math display">\[
I = I_0 \exp \left[-\int_S \mu (x, y)\, ds\right]
\tag{1}\]</span></span></p>
<p>가 된다. 중성자나 X-선의 경우 공기중의 선형 감쇠 계수는 매우 작기 때문에 우리가 관심이 있는 영역에서의 경로적분만을 생각하면 된다. 또한 빔이 <span class="math inline">\(x\)</span> 값이 고정된 직선 경로를 따른다면,</p>
<p><span id="eq-beam_intensity_2"><span class="math display">\[
I(x) = I_0 \exp \left[-\int_{y_i}^{y_f} \mu (x, y)\, dy\right]
\tag{2}\]</span></span></p>
<p>이다. 만약 물질이 없는 경로에서의 측정값이 있다면 <span class="math inline">\(I(x) = I_0\)</span> 가 될 것이다.</p>
<p>우리가 검출기에서 측정한 값이 <span class="math inline">\(\overline{I}(x)\)</span> 이며 물질이 없는 경로에서의 측정값 <span class="math inline">\(\overline{I_0}\)</span> 을 가지고 있다면,</p>
<p><span id="eq-beam_intensity_formula"><span class="math display">\[
-\ln \left(\dfrac{\overline{I}(x)}{\overline{I_0}}\right) = \int_{y_i}^{y_f} \mu (x, y)\, dy
\tag{3}\]</span></span></p>
<p>가 될 것이다.</p>
<p><br></p>
</section>
<section id="projection" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="projection"><span class="header-section-number">2</span> Projection</h2>
<p>토모그래피에 있어 물질은 <span class="math inline">\(\mu (x, y)\)</span> 를 의미한다. <span class="math inline">\(\mu\)</span> 는 선원, 물질의 종류 및 밀도에 따라 달라지는 값이며, 토모그래피는 projection들 을 모아 <span class="math inline">\(\mu(x, y)\)</span> (3차원 토모그래피의 경우는 <span class="math inline">\(\mu(x, y, z)\)</span>) 를 재구성(reconstruction) 하는 방법이다.</p>
<p>이제 선원과 검출기를 반시계방향으로 <span class="math inline">\(\theta\)</span> 만큼 돌려서 찍었다고 하자. 이 데이터를 <span class="math inline">\(I_\theta (x)\)</span> 라고 한다. 이것은 앞서 라돈 변환에서의 projection <span class="math inline">\(p_\theta(t)\)</span> 와 같다.</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/tomography/projection.png" class="img-fluid figure-img" width="600"></p>
<p></p><figcaption class="figure-caption">Projection</figcaption><p></p>
</figure>
</div>
</center>
<p><br> 이제 라돈 변환을 잠시 다른 모양의 동등한 식으로 바꿔 보자.</p>
<p><span id="eq-projection_1"><span class="math display">\[
p_\theta(t) = \int_{-\infty}^{\infty} \mu(x,\,y)\, \delta (x\cos \theta + y \sin \theta -t )\, dx\,dy
\tag{4}\]</span></span></p>
<p><br></p>
</section>
<section id="fourier-slice-theorem" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="fourier-slice-theorem"><span class="header-section-number">3</span> Fourier Slice Theorem</h2>
<section id="푸리에-변환과-역변환" class="level3">
<h3 class="anchored" data-anchor-id="푸리에-변환과-역변환">푸리에 변환과 역변환</h3>
<p>이차원 함수 <span class="math inline">\(f(x, y)\)</span> 을 2차원 푸리에변환 한 함수 <span class="math inline">\(\mathfrak{F}[f](u, v) = F(u, v)\)</span> 는 다음과 같다.</p>
<p><span class="math display">\[
F(u, v) = \mathfrak{F}[f](u, v) = \iint f(x, y) \, e^{-2\pi i ( ux+yv)}\, dx\, dy
\]</span></p>
<p>우리는 <span class="math inline">\(F(u, v)\)</span> 에 대한 푸리에 역변환으로부터 <span class="math inline">\(f(x, y) = \mathfrak{F}^{-1}[F](x, y)\)</span> 를 얻을 수 있다는 것을 알고 있다. 즉,</p>
<p><span class="math display">\[
f(x, y) = \mathfrak{F}^{-1}[F](x, y) = \iint F(u, v) \, e^{2\pi i (ux +yv)}\, du\, dv
\]</span></p>
<p>임을 안다. 즉 <span class="math inline">\(f(x, y)\)</span> 를 안다는 것과 <span class="math inline">\(F(u, v)\)</span> 를 안다는 것은 정확히 같은 것이다.</p>
<p><br></p>
</section>
<section id="projection-과-푸리에변환" class="level3">
<h3 class="anchored" data-anchor-id="projection-과-푸리에변환">Projection 과 푸리에변환</h3>
<p>Projection <span class="math inline">\(p_\theta (s)\)</span> 에 대한 1차원 푸리에 변환을 <span class="math inline">\(S_\theta(\omega)\)</span> 라 하면,</p>
<p><span id="eq-fourier_transform_of_projection"><span class="math display">\[
S_\theta(\rho) = \int p_\theta(t) \,e^{-2\pi i\rho t}\, dt
\tag{5}\]</span></span></p>
<p>이다.</p>
<p>아래의 그림처럼 <span class="math inline">\(\theta\)</span> 만큼 회전시킨 <span class="math inline">\(t-s\)</span> 좌표계를 생각하자. 그렇다면, <span class="math inline">\((x, y)\)</span> 와 <span class="math inline">\((t, x)\)</span> 의 관계는 아래와 같다.</p>
<p><span class="math display">\[
\begin{bmatrix} t \\ s \end{bmatrix} =  \begin{bmatrix} \cos \theta &amp; \sin \theta \\ - \sin \theta &amp; \cos \theta\end{bmatrix} \begin{bmatrix} x \\ y \end{bmatrix}
\]</span></p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/tomography/fourier_slice_theorem_1.png" class="img-fluid figure-img" width="500"></p>
<p></p><figcaption class="figure-caption">New coordinate system</figcaption><p></p>
</figure>
</div>
</center>
<p>라돈 변환을 생각하면,</p>
<p><span class="math display">\[
p_\theta (t) = \int f(t, s)\, ds
\]</span></p>
<p>이며 <a href="#eq-fourier_transform_of_projection">식&nbsp;5</a> 로 부터</p>
<p><span id="eq-fourier_transform_of_slice_2"><span class="math display">\[
\begin{aligned}
S_\theta (\rho) &amp;= \int p_\theta (t) e^{-2\pi i \rho t}\, dt \\
&amp;=\int \left[\int f(t, s) \, ds\right] \, e^{-2\pi i \rho t}\, dt \\
&amp;= \iint f(x, y) e^{-2 \pi i \rho ( x \cos\theta + y\sin \theta) } \, dx\, dy
\end{aligned}
\tag{6}\]</span></span></p>
<p>임을 안다. 여기서 <span class="math inline">\(u = \rho \cos \theta,\, v = \rho \sin \theta\)</span> 라고 하면,</p>
<p><span id="eq-fourier_transform_of_slice_3"><span class="math display">\[
S_\theta (\rho) = \iint f(x,  y) e^{-2\pi i (ux + vy)}\, dx\, dy = \mathfrak{F}[f](u, v) = F(\rho \cos \theta, \rho \sin \theta)
\tag{7}\]</span></span></p>
<p>이다. 이것이 바로 <strong>Fourier Slice Theorem</strong> 이다. Fourier slice theorem 은 sinogram 으로부터 <span class="math inline">\(f(x, y)\)</span> 를 구할 수 있음을, 즉 역 라돈 변환이 가능함을 보장한다.</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/tomography/Fourier_Slice_Theorem_2.png" class="img-fluid figure-img" width="600"></p>
<p></p><figcaption class="figure-caption">New coordinate system</figcaption><p></p>
</figure>
</div>
</center>
<p><br></p>
</section>
</section>
<section id="filtered-back-projeciton" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="filtered-back-projeciton"><span class="header-section-number">4</span> Filtered back projeciton</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
지금까지의 정리
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><span class="math inline">\(f(x, y)\)</span> 가 함수라고 하자. 그렇다면 우리는 임의의 projeciton <span class="math inline">\(p_\theta(t)\)</span> 를 얻을 수 있으며, 이를 통해 <span class="math inline">\(\mathfrak{F}[f](u, v)\)</span> 를 구할 수 있다.</p></li>
<li><p>우리가 토모그래피를 통해 측정하는 것은 <span class="math inline">\(\theta = \theta_1,\, \theta_2,\,\theta_3, \ldots\)</span> 에 대한 <span class="math inline">\(p_\theta (t)\)</span> 이다. 그리고 푸리에 변환을 통해 <span class="math inline">\(S_\theta (\omega)\)</span> 를 얻을 수 있다.</p></li>
<li><p><span class="math inline">\(S_\theta (\omega) = F(\omega \cos\theta, \omega \sin \theta)\)</span> 와 같다.</p></li>
</ul>
</div>
</div>
<p><br></p>
<section id="filtered-projection" class="level3">
<h3 class="anchored" data-anchor-id="filtered-projection">Filtered projection</h3>
<p><span id="eq-filtered_projeciton_1"><span class="math display">\[
\begin{aligned}
f(x, y) &amp;= \iint F(u, v) e^{2\pi i (ux + yv)}\, du\, dv \\
&amp;= \int_0^{2\pi}\int_0^{\infty} F(\rho \cos \theta, \rho \sin \theta)\, e^{2\pi i (\rho x \cos \theta + \rho y \sin \theta)} \, \rho\,   d\rho \, d\theta
\end{aligned}
\tag{8}\]</span></span></p>
<p>이며 <span class="math inline">\(\theta\)</span> 에 대한 적분을 <span class="math inline">\([0, \pi)\)</span>, <span class="math inline">\([\pi, 2\pi)\)</span> 구간으로 나누어 생각해 보자.</p>
<ul>
<li><p>Projection <span class="math inline">\(p_\theta (t)\)</span> 를 생각해보자. <span class="math inline">\(\theta + \pi\)</span> 만큼 회전시킨 projection 은 <span class="math inline">\(\theta\)</span> 에 대한 projection 과 같은 선상의 적분이며 단지 <span class="math inline">\(t\)</span> 값이 <span class="math inline">\(-t\)</span> 로 바뀔 뿐이다. 따라서 <span class="math inline">\(p_{\theta + \pi} (t) = p_\theta(-t)\)</span> 이다.</p></li>
<li><p>식 (<span class="math inline">\(6\)</span>) 으로부터, <span class="math inline">\(S_{\theta + \pi}(\rho) = S_\theta (-\rho)\)</span> 임을 안다. 따라서 다음이 성립한다. <span id="eq-filtered_projection_2"><span class="math display">\[
F(\rho \cos (\theta + \pi), \rho \sin (\theta + \pi)) = F(-\rho \cos \theta, -\rho \sin\theta)
\tag{9}\]</span></span></p></li>
</ul>
<p><br></p>
<p>그렇다면, <span class="math inline">\([\pi, 2\pi)\)</span> 구간에서 <span class="math inline">\(\phi = \theta - \pi\)</span> 로 놓으면, 그리고 중간에 <span class="math inline">\(\rho \to -\rho\)</span> 변환을 사용하면,</p>
<p><span id="eq-filtered_projection_3"><span class="math display">\[
\begin{aligned}
\int_\pi^{2\pi}\int_0^\infty &amp;F(\rho \cos \theta, \rho \sin \theta)\,  e^{2\pi i (\rho x \cos \theta + \rho y \sin \theta)} \, \rho\,   d\rho \, d\theta\\
&amp;=\int_0^\pi \int_0^\infty F(-\rho\cos \phi, -\rho \sin \phi) e^{-2\pi i(\rho x \cos \phi +\rho y \sin\phi)} \, \rho\, d\rho \, d\phi \\
&amp; = \int_0^\pi \int_{-\infty}^0 F(\rho \cos \phi,  \rho \sin \phi) e^{2\pi i (\rho x \cos \theta + \rho y \sin \theta)} (-\rho)\, d\rho \,d\phi
\end{aligned}
\tag{10}\]</span></span></p>
<p>이다. <a href="#eq-fourier_transform_of_slice_3">식&nbsp;7</a> 과 <a href="#eq-filtered_projection_3">식&nbsp;10</a> 로부터, 그리고 Fourier slice theorem 으로부터,</p>
<p><span class="math display">\[
\begin{aligned}
f(x, y) &amp;=\int_0^{ \pi} \int_{-\infty}^\infty F(\rho \cos\theta, \rho \sin \theta) e^{2\pi i \rho(x \cos \theta + y \sin \theta)}|\rho| \, d\rho \, d\theta \\
&amp;= \int_0^\pi \left[ \int_{0}^\infty S_\theta (\rho) |\rho| e^{2\pi i \rho (x\cos \theta + y \sin \theta)}\, d\rho \right] \, d\theta
\end{aligned}
\]</span></p>
<p>를 얻는다. 우리는 <span class="math inline">\(t=x \cos \theta + y \sin \theta\)</span> 가 <span class="math inline">\(\theta\)</span> 만큼 회전시켰을때의 projection 이 독립변수임을(혹은 좌표값임을) 알고 있다. 따라서</p>
<p><span id="eq-fourier_transform_of_slice_4"><span class="math display">\[
Q_\theta (t) = \int_{0}^\infty S_\theta(\rho) |\rho| e^{2\pi i \rho t} \, d\rho
\tag{11}\]</span></span></p>
<p>라고 정의하자. 그렇다면</p>
<p><span id="eq-fourier_transform_of_slice_5"><span class="math display">\[
f(x, y) = \int_0 ^\pi  Q_\theta (t = x \cos \theta + y \sin \theta) \,d\theta
\tag{12}\]</span></span></p>
<p>가 된다. 이 때의 <span class="math inline">\(Q_\theta (t)\)</span> 를 <strong>filtered projection</strong> 이라고 하며 filtered projection 을 통해 <span class="math inline">\(f(x, y)\)</span> 를 얻는 과정을 <strong>filtered back projection</strong> 이라고 한다. 즉 filtered back projection 은 다음의 과정을 통해 원본 이미지를 reconstructin 한다.</p>
<p><span class="math display">\[
p_\theta (t) \longrightarrow S_\theta (\rho) \longrightarrow Q_\theta(t) \longrightarrow f(x, y)
\]</span></p>
<p>우리가 image 를 reconstruction 할 때는 영역을 선택한다. 이를 reconstruction region 이라고 하자. 이 영역에 대해 <span class="math inline">\(f(x,\,y)\)</span> 를 구해야 한다. 다음 그림을 보자</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/tomography/filtered_projection.png" class="img-fluid figure-img" width="600"></p>
<p></p><figcaption class="figure-caption">Filtered projection</figcaption><p></p>
</figure>
</div>
</center>
<p>우리는 <span class="math inline">\(\theta = \theta_1,\,\theta_2,\ldots\)</span> 에 대한 slices <span class="math inline">\(p_\theta (t)\)</span> 를 얻었으며 이를 통해 각 slices 에 대한 <span class="math inline">\(Q_\theta (t)\)</span> 를 얻을 수 있다. <span class="math inline">\(Q_\theta(t)\)</span> 를 얻었다면 식 (<span class="math inline">\(11\)</span>) 로 부터 <span class="math inline">\(f(x,\,y)\)</span> 를 얻을 수 있는데, 실제로 reconstruction 을 할 때는 적분을 합으로 바꾸게 된다. 즉,</p>
<p><span class="math display">\[
f(x, y) = C \cdot \left(\sum_\theta Q_\theta (t=x \cos \theta + y \sin \theta)\right)
\]</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../src/image_processing/fourier_transform.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">푸리에 변환</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>